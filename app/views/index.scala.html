@import forms._
@(workflows : List[FormDefinition])(userUploads : List[UserUpload])

@main(title = "The Kurator 'helloworld' application") {

    <h2>Workflows</h2>

    <script type="text/javascript" src="@routes.Assets.at("javascripts/workflow.js")"></script>
    <script type="text/javascript">
                $.ajax({ url: "@routes.Workflows.status(session.get("uid"))", success: updateWorkflowRuns});

                (function poll() {
                    setTimeout(function() {
                        $.ajax({ url: "@routes.Workflows.status(session.get("uid"))", success: updateWorkflowRuns, dataType: "json", complete: poll });
                    }, 3000);
                })()

            /*;*/
    </script>
    <table class="workflow-list">
        @workflows.map { workflow =>
            <tr>
                <td>
                    @if(workflow.documentation != null) {
                        <a href="@workflow.documentation"><img src="@routes.Assets.at("images/info.png")" /></a>
                    }
                </td>
                <td>
                    @workflow.title
                </td>
                <td>
                    <a href="workflow/@workflow.name">Run</a>
                </td>
                <td style="width: 500px">
                    @workflow.instructions
                </td>
            </tr>
        }
    </table>

    <h1>Workflow runs</h1>

    <script type="text/javascript">
            $(document).ready(function() {
                $('#workflow-runs').DataTable();
            } );
    </script>

    <div id="workflow-runs" style="float: left">

    </div>

}

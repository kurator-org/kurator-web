@import forms._
@(workflows : List[FormDefinition])(workflowRuns : List[WorkflowRun])(userUploads : List[UserUpload])

<ul id="navbar">
    <li><a class="active" href="@routes.Application.index">Home</a></li>
    <li><a href="@routes.Application.builder">Workflow Builder</a></li>
    <li><a href="@routes.Application.createaccount">Register</a></li>
    @if(session.get("uid").equals("1")) {
        <li><a href="@routes.Application.manager">User Management</a></li>
    }
    @if(session.get("uid") == null) {
        <li><a href="@routes.Application.login">Login</a></li>
    } else {
        <li><a href="@routes.Application.logout">Logout</a></li>
    }
</ul>

@main(title = "The Kurator 'helloworld' application") {

    <h1>Kurator workflows</h1>

        @workflows.map { workflow =>
            <li>
                <a href="workflow/@workflow.name">Run "@workflow.title"</a>
                @if(workflow.documentation != null) {
                    <a href="@workflow.documentation"><img src="@routes.Assets.at("images/info.png")" /></a>
                }
            </li>
        }

    <h1>Workflow runs</h1>
    <p>
        @if(workflowRuns.isEmpty) {
            <i>No workflow runs</i>
        } else {
            <table>
                <tr>
                    <th>Workflow</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Result</th>
                    <th>Output Log</th>
                    <th>Error Log</th>
                </tr>
                @workflowRuns.map { workflowRun =>
                    <tr @if(workflowRun.result != null && !workflowRun.result.errorText.equals("")) { class="error" }>
                        <td>@workflowRun.workflow.title</td>
                        <td>@workflowRun.startTime</td>
                        <td>@workflowRun.endTime</td>
                        <td>@if(workflowRun.result == null || workflowRun.result.resultFiles.isEmpty()) {
                                Unavailable
                            } else {
                                <a href="result/@workflowRun.id">Download</a>
                            }
                        </td>
                        <td>@if(workflowRun.result != null && !workflowRun.result.outputText.equals("")) {
                            Output <a href="output/@workflowRun.id">(view log)</a>
                            } else {                            No Output
                            }
                        </td>
                        <td>@if(workflowRun.result != null && !workflowRun.result.errorText.equals("")) {
                            Error <a href="error/@workflowRun.id">(view stack trace)</a>
                            } else {
                            No Errors
                            }
                        </td>
                    </tr>
                }
            </table>
        }
    </p>

    <h1>Uploads</h1>
    <p>
        @if(userUploads.isEmpty) {
            <i>No user uploads</i>
        } else {
            <ul>
                @userUploads.map { userUpload =>
                    <li><a href="file/@userUpload.id">@userUpload.fileName</a></li>
                }
            </ul>
        }
    </p>
    
}

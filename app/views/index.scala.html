@import forms._
@(workflows : List[FormDefinition])(userUploads : List[UserUpload])

@main(title = "The Kurator 'helloworld' application") {

    <h2>Workflows</h2>

    <script type="text/javascript" src="@routes.Assets.at("javascripts/workflow.js")"></script>
    <script type="text/javascript">
                $.ajax({ url: "@routes.Workflows.status(session.get("uid"))", success: updateWorkflowRuns});

                (function poll() {
                    setTimeout(function() {
                        $.ajax({ url: "@routes.Workflows.status(session.get("uid"))", success: updateWorkflowRuns, dataType: "json", complete: poll });
                    }, 3000);
                })()

            /*;*/
    </script>
    <br/>


    <table class="workflow-list">
        @if(workflows.size() == 0) {
           <i>No workflows deployed</i>
        } else {

            <thead>
                <tr >
                <th style="padding-bottom: 15px" colspan="2">
                    <div class="input-group">
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
                        </span>

                        <input type="text" class="form-control" placeholder="Search...">
                    </div>
                </th>
                    <th></th>
                <th style="padding-bottom: 15px">

                    <div style="vertical-align: middle; float: right">
                    <span style="padding-right: 10px">@workflows.size() of @workflows.size()</span>

                    <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon glyphicon-chevron-left"></span></button>
                        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon glyphicon-chevron-right"></span></button>
                    </div>
                    </div>
                </th>
                </tr>
            </thead>
        }

        @workflows.map { workflow =>
            <tr>
                <td>
                    @if(workflow.documentation != null) {
                        <a href="@workflow.documentation"><img src="@routes.Assets.at("images/info.png")" /></a>
                    }
                </td>
                <td>
                    @workflow.title
                </td>
                <td>
                    <a href="workflow/@workflow.name">Run</a>
                </td>
                <td style="width: 500px">
                    @workflow.summary
                </td>
            </tr>
        }
    </table>

    <h2>Workflow runs</h2>

    <div id="workflow-runs" style="float: left">

    </div>

}

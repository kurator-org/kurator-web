@import forms._
@(workflows : List[FormDefinition])(workflowRuns : List[WorkflowRun])(userUploads : List[UserUpload])

<ul id="navbar">
    <li><a class="active" href="@routes.Application.index">Home</a></li>
    <li><a href="@routes.Application.builder">Workflow Builder</a></li>
    <li><a href="@routes.Application.createaccount">Register</a></li>
    @if(session.get("uid") == null) {
        <li><a href="@routes.Application.login">Login</a></li>
    } else {
        <li><a href="@routes.Application.logout">Logout</a></li>
    }
</ul>

@main(title = "The Kurator 'helloworld' application") {

    <h1>Kurator workflows</h1>

    <!-- <ul>
        @workflows.map { workflow =>
            <li><a href="workflow/@workflow.name">Run "@workflow.title"</a></li>
        }
    </ul> -->

    <ul>
        <li><a href="@routes.Workflow.helloworkflow">Run "Hello World" workflow</a></li>
        <li><a href="@routes.Workflow.wormsworkflow">Run WoRMS demo workflow</a></li>
        <li><a href="@routes.Workflow.geoworkflow">Run Geo Validator demo workflow</a></li>
    </ul>

    <h1>Workflow runs</h1>
    <p>
        @if(workflowRuns.isEmpty) {
            <i>No workflow runs</i>
        } else {
            <table>
                <tr><td>Workflow</td><td>Start Time</td><td>End Time</td><td>Result</td><td>Output Log</td><td>Error Log</td></tr>
                @workflowRuns.map { workflowRun =>
                    <tr @if(!workflowRun.result.errorText.equals("")) { class="error" }>
                        <td>@workflowRun.workflow</td>
                        <td>@workflowRun.startTime</td>
                        <td>@workflowRun.endTime</td>
                        <td>@if(workflowRun.result == null || workflowRun.result.getResultFileName == null) {
                                Unavailable
                            } else {
                                <a href="result/@workflowRun.id">@workflowRun.result.getResultFileName</a>
                            }
                        </td>
                        <td>@if(!workflowRun.result.errorText.equals("")) {
                                Error <a href="error/@workflowRun.id">(view stack trace)</a>
                            } else {
                                No Errors
                            }
                        </td>
                        <td>@if(!workflowRun.result.outputText.equals("")) {
                                Output <a href="output/@workflowRun.id">(view log)</a>
                            } else {
                                No Output
                            }
                        </td>
                    </tr>
                }
            </table>
        }
    </p>

    <h1>Uploads</h1>
    <p>
        @if(userUploads.isEmpty) {
            <i>No user uploads</i>
        } else {
            <ul>
                @userUploads.map { userUpload =>
                    <li><a href="file/@userUpload.id">@userUpload.fileName</a></li>
                }
            </ul>
        }
    </p>
    
}

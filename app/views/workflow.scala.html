
<!DOCTYPE html>

<html>
<head>
    <title>Workflow</title>
    <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
    <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
    <script src="@routes.Assets.at("javascripts/jquery-1.6.4.min.js")" type="text/javascript"></script>
    <script type="text/javascript" src="@routes.Application.jsRoutes"></script>
</head>
<body>
    <h1>Run Workflow</h1>

    <form enctype="multipart/form-data">
    <input type="file" id="input" name="input">
    </form>

     <script type="text/javascript">
        $(function() {
            $("#complete").hide();

            $("#run").click(function() {
                jsRoutes.controllers.Application.run().ajax({
                    success: function (data) {
                        $("#result").html(data.output);
                        $("#download").attr("href", "/result/" + data.filename);
                        console.log(data)
                        $("#complete").show("drop");
                    }
                });
            });

            // grab your file object from a file input
            $('#input').change(function () {
                var file = this.files[0];
                $.ajax({
                    type: 'post',
                    url: '/upload',
                    data: file,
                    success: function (data) {
                        $("#result").html(data.output);
                        $("#download").attr("href", "/result/" + data.filename);
                        console.log(data)
                        $("#complete").show("drop");
                    },
                    processData: false,
                    contentType: file.type
                });
            });

        });
     </script>

    <button id="run">Run workflow</button>
    <div id="complete">
        Result: <span id="result"></span>
        <a id="download">Download csv...</a>
    </div>
</body>
</html>
